import "math.mscript";
import "util.mscript";

int array_to_int(int[] array) {
    if (array.length > 0) {
        return array[0];
    }
    return 0;
}

int count_array(int[] array) {
    double_array(array);

    int sum = 0;
    int i;
    for (i = 0; i < array.length; i++) {
        sum = sum + array[i+1.0];
    }

    return array_to_int(array);

    if (sum > 0) {
        return sum;
    }
    else if (sum < 0) {
        return 0;
    }
    return 100;
}

void double_array(int[] array) {
    int i;
    for (i = 0; i < array.length; i++) {
        array[i] = 2 * array[i];
        if (i > 2) {
            return;
        }
    }
}

struct test {
    vec2 t;
}

struct foo {
    vec3 v0;
    vec3 v1;
}

struct bar {
    vec3[] a;
    bar[] children;
}

void recurse(bar b) {
    int i;
    for (i = 0; i < b.children.length; i++) {
        recurse((b.children)[i]);
    }
}

int recur1(int a) {
    if (a > 0) {
        return recur2(a - 1);
    }
    return 0;
}

int recur2(int b) {
    if (b > 0) {
        return recur2(b - 1);
    }
    return 0;
}

int run() {
    bar[] bars = [ { a = [ { x = 1, y = 2, z = 3 } ] } ];
    (bars[0].a)[1].x = 10;

    bars[0].a = [ ];

    vec3[] aaa = bars[0].a;
    aaa[0] = { x = 2, y = 3, z = 4 };

    vec3[] array = [ { x = 1, y = 2, z = 3 }, { x = 1, y = 2, z = 3 } ];
    array[0].x = 10;

    int d = count_array([1.0, 2, 3.0]);

    vec3 a = { x = 1, y = 2, z = 3 };
    vec3 b = { x = 1, y = 2, z = 3 };

    vec3 vec3 = { x = 1 };
    vec3.y = vec3.x + vec3.x;
    vec3 v = { x = 1 };
    foo f = { 
        v0 = { x = v.x, y = v.y, z = v.z },
        v1 = { x = 1, y = 2, z = 3 }
    };
    int s = vec3_scale(vec3, vec3.x).x;
    return vec3_distance({ x = 1, y = 2, z = 3 }, { x = 1, y = 2, z = 30 });
}
