import "math.mscript";
import "util.mscript";
import "terrain_generation_common.mscript";

int fib1(int n) {
    if (n <= 0) {
        return 0;
    }
    else if (n == 1) {
        return 1;
    }
    else {
        return fib1(n - 1) + fib2(n - 2);
    }
}

int fib2(int n) {
    if (n <= 0) {
        return 0;
    }
    else if (n == 1) {
        return 1;
    }
    else {
        return fib2(n - 1) + fib1(n - 2);
    }
}

int fib(int n) {
    if (n <= zero()) {
        return zero();
    }
    else if (n == one()) {
        return one();
    }
    else {
        return fib1(n - one()) + fib2(n - two());
    }
}

int zero() {
    return 0;
}

int one() {
    return 1;
}

int two() {
    return 2;
}

vec3[] create_array(int n) {
    vec3[] a = [];
    int i;
    for (i = 0; i < n; i++) {
        a[i] = { x = 3.0 * i + 0.0, y = 3.0 * i + 1.0, z = 3.0 * i + 2.0 };
    }
    return a;
}

vec3 sum_array(vec3[] array) {
    vec3 sum = { x = 0, y = 0, z = 0 };
    int i;
    for (i = 0; i < array.length; i++) {
        sum = vec3_add(sum, array[i]);
    }
    return sum;
}

void double_array(vec3[] array) {
    int i;
    for (i = 0; i < array.length; i++) {
        array[i] = vec3_scale(array[i], 2.0);
    }
}

void print_array(vec3[] array) {
    print("[");
    int i;
    for (i = 0; i < array.length; i++) {
        print(array[i]);
        if (i != array.length - 1) {
            print(", ");
        }
    }
    print("]\n");
}

float PI2 = 2.0*PI;

int run(int n) {
    float x = 5;
    print("x = ", x, "\n");

    x += 5;
    print("x = ", x, "\n");

    x += 10;
    print("x = ", x, "\n");
    
    x /= 3;
    print("x = ", x, "\n");

    x *= 3;
    print("x = ", x, "\n");

    print("fib(10) = ", fib(10), "\n");

    {
        ui_state state = UI_STATE_MAIN;
        print_ui_state(state);
        print("\n");
        if (state == UI_STATE_MAIN) {
            state = UI_STATE_SETTINGS;
        }
        print_ui_state(state);
        print("\n");
        if (state == UI_STATE_SETTINGS) {
            state = UI_STATE_MAIN;
        }
        print_ui_state(state);
        print("\n");
    }

    {
        int[] testing = NULL;

        if (!testing) {
            print("YES NULL\n");
        }
        else {
            print("NO NULL\n");
        }

        vec2 p0 = { x = 0.00, y = 0.00 };
        vec2 p1 = { x = 0.33, y = 0.10 };
        vec2 p2 = { x = 0.66, y = 0.50 };
        vec2 p3 = { x = 1.00, y = 1.00 };
        float t = 1.0;
        vec2 p = vec2_bezier(p0, p1, p2, p3, t);
        print("p: ", p, "\n");
    }

    {
        vec3 v = { x = 1, y = 2, z = 3 };
        float f = vec3_length_sqrd(v);
        print("length_sqrd: ", f, "\n");
    }

    float pipi = 2.0*PI;

    int i = 10;
    bool b;
    if (i == 10) {
        b = true;
    }
    else {
        b = false;
    }
    print("b: ", b, "\n");

    bool b0 = true;
    bool b1 = false;
    if (b0 == b1) {
        print("nonononono\n");
    }
    if (b0 != b1) {
        print("yesyeysyesy\n");
    }

    vec3[] a = create_array(n);
    print_array(a);
    double_array(a);
    vec3 sum = sum_array(a);
    return sum.x + sum.y + sum.z;
}
